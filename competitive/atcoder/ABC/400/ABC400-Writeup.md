# AtCoder Beginner Contest 400

## C - $2^a b^2$

### 問題概要

* 与えられた整数 $N$ に対して、$1 \le X \le N$ の **良い整数** の個数を求める。
* 良い整数とは、正の整数 $a,b$ を用いて
  $$
  X = 2^a \times b^2
  $$
  と表せる整数のこと。
* 制約：$1 \le N \le 10^{18}$

---

### 着眼点

$X = 2^a \times b^2$ の形に注目して、$2$ の指数 $a$ の **偶奇** で場合分けする。

#### 偶数の場合（$a = 2k$）

$$
X = 2^{2k} b^2 = (2^k b)^2
$$

つまり平方数であり、かつ $a \ge 2$ より **$4 \times$ 平方数** の形になる。

#### 奇数の場合（$a = 2k + 1$）

$$
X = 2^{2k+1} b^2 = 2(2^k b)^2
$$

つまり **$2 \times$ 平方数** の形になる。

したがって良い整数は：

* (A) $2 \times$ 平方数
* (B) $4 \times$ 平方数

のいずれかに必ず一致する。

(A) と (B) が重なることはない（もし $2m^2 = 4n^2$ なら $m^2 = 2n^2$ で整数では不可能）。

---

### 個数の求め方

それぞれの形の整数が $N$ 以下である条件を変形する。

* (A) の形：$2m^2 \le N \ \Rightarrow\ m \le \sqrt{N/2}$
* (B) の形：$4m^2 \le N \ \Rightarrow\ m \le \sqrt{N/4}$

したがって、

$$
\text{答え} =
\left\lfloor \sqrt{\frac{N}{2}} \right\rfloor +
\left\lfloor \sqrt{\frac{N}{4}} \right\rfloor
$$

---

### 学びポイント

* $v_2(X)$（$X$ の 2 進素因数の個数）の偶奇で分類できる。
* 2 の指数の偶奇によって平方数の「外に出る 2」が決まる。
* 浮動小数点誤差を避けるには整数演算（`isqrt`）が最強。

---
