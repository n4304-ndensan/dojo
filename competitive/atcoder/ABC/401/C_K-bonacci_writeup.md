# ABC401 C問題 K-bonacci Writeup

## 問題概要

K-bonacci数列とは、フィボナッチ数列を一般化したもので、

* 最初の **k項はすべて1**
* それ以降の項は直前の **k項の和**

で定義される数列。

例: k=3 の場合

```
1, 1, 1, 3, 5, 9, 17, ...
```

今回の課題は **n番目のK-bonacci数を 10^9 で割った余り** を求める。
ただし n は 50万など非常に大きい入力も想定される。

---

## 解法

### 1. Naive再帰

* `kBonacci(i) = kBonacci(i-1) + ... + kBonacci(i-k)`
* 再帰で実装可能だが、`n=500000` のような大きな入力では **StackOverflowError** が発生。
* 計算量も指数的に爆発する。

### 2. 動的計画法（DP, O(n)）

* 配列 `a[i]` に各項を格納。
* 累積和 `sumList[i]` を使うことで

  ```
  a[i] = sumList[i] - sumList[i-k]
  ```

  と高速に計算できる。
* 計算量は O(n)、メモリも O(n)。
* n=50万程度なら一瞬で計算可能。

### 3. さらに大規模な n の場合

* n が 10^9 以上になると O(n) でも計算が間に合わない。
* この場合は **行列累乗（Matrix Exponentiation）** を使い、O(k³ log n) で計算可能。

---

## 学び

* **再帰実装はスタックオーバーフローの危険がある** → 大規模入力には不向き。
* **累積和＋DP** を使えば計算量を大幅に削減できる。
* 数列問題では **行列累乗** が万能な解法。
* mod 計算は逐次 `% mod` を取るのが安全。

---
