# C Equilateral Triangle

## 問題概要

円周が $L$ の円があり、その上に $N$ 個の点が順に配置されている。
点の配置は入力で与えられる差分 $d_i$ に従う。

求めるのは、

$$
(a,b,c) \quad (1 \leq a < b < c \leq N)
$$

で次の条件を満たす組の個数:

1. $a,b,c$ が異なる位置にある
2. 三角形 $abc$ が正三角形である

---

## 解法

### 1. 点の位置を求める

点は順に次のように決まる。

$$
pos_{i+1} = (pos_i + d_i) \bmod L
$$

ただし $(pos_i + d_i) \bmod L = 0$ の場合は $L$ の位置に置く。
各位置に存在する点の数を配列 $d[1..L]$ にカウントする。

---

### 2. 正三角形を作れる条件

円周を正三角形で分割するためには、**円周が 3 等分可能**である必要がある。
すなわち、

$$
L \equiv 0 \pmod{3}
$$

でなければ答えは $0$。

もし $c = \frac{L}{3}$ とすると、
ある点 $a$ に対して三角形を作れる位置は

$$
a, \quad a+c, \quad a+2c
$$

である。

---

### 3. 組み合わせの数え方

もし位置 $a, a+c, a+2c$ にある点の個数が

$$
d[a], \quad d[a+c], \quad d[a+2c]
$$

であれば、作れる三角形の個数は

$$
d[a] \times d[a+c] \times d[a+2c]
$$

である。

---

### 4. アルゴリズム

1. 各点の位置を計算し、配列 $d$ にカウントする。
2. $L \bmod 3 \neq 0$ なら答えは $0$。
3. $c = L/3$ として、

   $$
   ans = \sum_{a=1}^{c} d[a] \cdot d[a+c] \cdot d[a+2c]
   $$

   を計算して答えとする。

---

## 計算量

- 前処理: $O(N)$
- 三角形探索: $O(L)$

制約 $N,L \leq 3\times 10^5$ に対して十分高速。

---

## まとめ

- 円周が 3 等分できるかが鍵
- 各点の位置をカウントし、

  $$
  d[a] \cdot d[a+c] \cdot d[a+2c]
  $$

  を積み上げるだけで答えが得られる

---
