# C - Rotatable Array

## 問題情報

**Description:**

- 長さ N の整数列 A があり、初期状態は A[i] = i (1 ≤ i ≤ N)。
- Q 個のクエリを処理する:

  1. `1 p x` : A[p] を x に変更する
  2. `2 p` : A[p] を出力する
  3. `3 k` : 先頭の要素を末尾に送る操作を k 回繰り返す

制約:

- 1 ≤ N ≤ 10^6
- 1 ≤ Q ≤ 3×10^5
- 1 ≤ k ≤ 10^9

---

## 解法

### アルゴリズム概要

- クエリ 3 を素直に処理すると O(N) になり間に合わない。
- **オフセット管理**を導入し、配列を回転させずに「先頭位置」を変数 `offset` で表現する。
- 実際のアクセスは

```rs
idx = (offset + p - 1) % N
```

によって計算する。

- よってクエリ 1・2・3 すべて O(1) で処理可能。

---

## 実装のポイント

- クエリ 3 は `offset = (offset + k) % N` とするだけでよい。
- クエリ 1・2 では添字計算にオフセットを反映する。
- 入力が大きいため、高速入出力（まとめて読み込み・逐次出力）を意識する。

---

## 計算量

- 各クエリ O(1)
- 全体 O(Q)
- メモリ O(N)

制約内で十分高速に動作する。

---

## 関連技術

- **オフセット管理 (Lazy Rotation)**
- 配列アクセスの添字変換

---
