# 差分更新（Difference Update）

## 概要

差分更新とは、データ構造の全体を再計算するのではなく、**変更が発生した部分のみを更新**する手法。動的配列・区間演算・グラフ更新などで利用される。

## 目的

* 計算量削減：$O(N)$ → $O(1)$ または $O(\log N)$
* 更新頻度が高く、クエリ回数が多い場面で有効。

## 基本原理

更新操作の「差分」を蓄積しておき、必要なときにまとめて反映する。

### 例：区間加算（累積差分法）

```pseudo
add(l, r, x):
    diff[l] += x
    diff[r+1] -= x

# 後で累積して実値を得る
for i in range(1, n+1):
    arr[i] = arr[i-1] + diff[i]
```

### 例：部分木更新（DFS順序を利用）

木構造に対して Euler Tour による入出時刻を利用し、差分更新可能。

## 応用例

* imos法
* Fenwick木 / BIT（Binary Indexed Tree）
* セグメント木の遅延伝播

## 注意点

* 遅延適用が必要な場合、クエリ時に「再構築」または「累積処理」が必要。
* インデックス境界（$r+1$ の扱いなど）に注意。
