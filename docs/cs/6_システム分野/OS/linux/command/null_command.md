#  `:` 

## 概要

`:`（コロン）は、POSIX互換シェル（bash, sh, zsh など）において非常に基本的かつ重要な**ビルトインコマンド（組み込みコマンド）**である。その機能は一見単純だが、シェルスクリプト設計の中で多様な役割を果たす。

---

## 1. 基本的な動作

### 定義

`:` は **null command（ヌルコマンド）** と呼ばれ、実行すると「何もしない」コマンドである。

### 挙動

* 標準出力を出さない。
* 標準エラーも出さない。
* 常に終了コード `0`（成功）を返す。

### 実例

```bash
$ :
$ echo $?
0
```

上記の例では、`:` は何もせずに終了し、`$?` によって「成功」を示す `0` が返る。

---

## 2. `:` の実用的な使い方

### (1) プレースホルダー（何もしない箇所の明示）

```bash
if [ "$DEBUG" = true ]; then
  :  # 何もせず成功を返す
else
  echo "Debug mode off"
fi
```

`:` を使うことで、「ここに処理を入れる予定だが現時点では空」と明示できる。

---

### (2) 変数のデフォルト値設定（パラメータ展開）

```bash
: ${USER_NAME:=default_user}
```

* `USER_NAME` が未定義の場合に `USER_NAME=default_user` を設定する。
* `:` 自体は実行時に何の出力も行わないため、副作用を避けた安全な書き方として用いられる。

---

### (3) コマンド連結での無操作

```bash
: && echo "ok"
```

上記は常に成功するため、常に `ok` が表示される。

逆に、条件式の文法上コマンドが必要な箇所に「空操作」を挿入する用途にも使われる。

---

### (4) ファイルへの空書き込み（リダイレクトとの組み合わせ）

```bash
: > file.txt
```

→ `file.txt` が存在しない場合は空ファイルを作成し、存在する場合は中身を空にする。

これは `> file.txt` 単体よりも明示的で安全な意図表現となる。

---

## 3. 実装的背景

* `/bin/:` という実行ファイルは存在せず、`:` はシェル内部で処理される。
* ソースコード的には、bash や dash の組み込みコマンドテーブルで `:` は no-op として登録されている。
* `:` の戻り値は明示的に `return 0` で固定されている。

---

## 4. 他のnullコマンドとの比較

| コマンド    | 意味    | 出力 | 終了コード |
| ------- | ----- | -- | ----- |
| `:`     | 何もしない | なし | 0     |
| `true`  | 常に成功  | なし | 0     |
| `false` | 常に失敗  | なし | 1     |

`:` は `true` とほぼ同等だが、文法上より軽量で高速である。

---

## 5. 応用的利用例

### (1) 無限ループ

```bash
while :; do
  echo "looping..."
  sleep 1
done
```

`while :` は「常に真（0を返す）」ため、無限ループを作る標準的な方法。

---

### (2) コマンド置換内でのトリック

```bash
result=`:; echo done`
echo $result  # done
```

バッククォート内では `:` 自体が何も出力しないため、出力操作だけを残す用途に使える。

---

## 6. まとめ

* `:` は **何もしないが常に成功するコマンド**。
* スクリプト中での空操作、条件構文、変数初期化、リダイレクト制御など、用途は多岐にわたる。
* `:` の正しい理解は、POSIXシェルの制御構造を精密に扱う上で欠かせない基礎知識である。
