# バケット法（Bucket Method）

## 概要

**バケット法**（Bucket Technique）とは、データを区間やカテゴリに分けて管理し、範囲処理や高速検索を効率化するアルゴリズム手法である。

## 主な用途

- ソート（バケットソート）
    
- 区間集計（平方分割）
    
- オフラインクエリ（Mo’s Algorithm）
    

## 基本原理

要素数 NN の配列を N\sqrt{N} 程度のバケット数に分割し、

- 各バケットに要約情報（最小値・最大値・和など）を保持。
    
- 部分クエリは、バケット単位で高速に処理し、部分的に個別処理。
    

## 計算量

- 構築：O(N)O(N)
    
- クエリ：O(N)O(\sqrt{N}) 程度（平方分割法）
    

## 応用例

1. **平方分割 (Sqrt Decomposition)**：区間和や区間最小値の高速計算。
    
2. **バケットソート**：値域が狭い実数列を高速に整列。
    
3. **ヒストグラム処理**：範囲に基づく頻度分布の集計。
    

## 擬似コード（平方分割）

```python
import math
n = len(a)
bsize = int(math.sqrt(n))
bucket = [sum(a[i:i+bsize]) for i in range(0, n, bsize)]

def range_sum(l, r):
    s = 0
    while l < r and l % bsize != 0:
        s += a[l]; l += 1
    while l + bsize <= r:
        s += bucket[l // bsize]; l += bsize
    while l < r:
        s += a[l]; l += 1
    return s
```

## 注意

- 区間のサイズ設計（N\sqrt{N}）が性能に大きく影響。
    
- 更新クエリが多い場合はセグメント木などと比較検討が必要。